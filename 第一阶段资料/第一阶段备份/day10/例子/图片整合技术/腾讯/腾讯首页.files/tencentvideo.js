if(typeof tencent_ad=='undefined'){tencent_ad=(function(){String.prototype.format=function(config){return this.replace(/\{([^}]+)\}/g,function(m,i){return config[i]||''})};var each=function(iterator,fn,bind){if(typeof iterator.length=='number'){var results=[];for(var i=0,len=iterator.length;i<len;i++){results.push(fn.call(bind,iterator[i],i))}return results}else{var results={};for(var i in iterator){if(iterator.hasOwnProperty(i)){results[i]=fn.call(bind,iterator[i],i)}}return results}};var getId=(function(){var id=1;return function(){return'tencent_ad_'+id++}})();var apply=function(o,c){if(o&&c&&typeof c=='object'){for(var p in c){o[p]=c[p]}}return o};var __px_units='width,height,left,top,right,bottom';var buildElement=function(o){if(typeof o=='string'){return o}var begin=[];var middle=[];var end=[];var self=arguments.callee;var tag=o.tag||'div';begin.push('<',tag,' ');end.push('</',tag,'>');if(o.styles){begin.push('style="');each(o.styles,function(value,name){if(__px_units.indexOf(name)!=-1){value=value+'';if(value.indexOf('px')==-1&&value.indexOf('%')==-1){value+='px'}}begin.push(name,':',value,';')});begin.push('" ')}if(o.attrs){each(o.attrs,function(value,name){begin.push(name,'="',value,'" ')})}begin.push('>');var children=o.children;if(children){if(children.constructor!=Array){children=[children]}each(children,function(eachEl){middle.push(self(eachEl))})}return begin.concat(middle).concat(end).join('')};var createElement=function(html){var div=document.createElement('div');div.innerHTML=html;return div.childNodes.length>1?div.childNodes:div.firstChild};var toQueryString=function(o){var querystring=[];each(o,function(value,name){querystring.push(name+'='+encodeURIComponent(value))});return querystring.join('&')};var $=function(id){if(typeof id=='string'){return document.getElementById(id)}return id};var browser={};if(window.opera){browser.opera=true}else if(window.ActiveXObject){browser.ie=true}else if(!navigator.taintEnabled){browser.safari=true}else if(document.getBoxObjectFor!=null){browser.gecko=true}var patterns={HYPHEN:/(-[a-z])/i,ROOT_TAG:/^body|html$/i};var toCamel=function(property){if(!patterns.HYPHEN.test(property)){return property}if(propertyCache[property]){return propertyCache[property]}var converted=property;while(patterns.HYPHEN.exec(converted)){converted=converted.replace(RegExp.$1,RegExp.$1.substr(1).toUpperCase())}propertyCache[property]=converted;return converted};var getStyle=(function(){if(document.defaultView&&document.defaultView.getComputedStyle){return function(el,property){var value=null;if(property=='float'){property='cssFloat'}var computed=document.defaultView.getComputedStyle(el,'');if(computed){value=computed[toCamel(property)]}return el.style[property]||value}}else if(document.documentElement.currentStyle&&browser.ie){return function(el,property){switch(toCamel(property)){case'opacity':var val=100;try{val=el.filters['DXImageTransform.Microsoft.Alpha'].opacity}catch(e){try{val=el.filters('alpha').opacity}catch(e){}}return val/100;case'float':property='styleFloat';default:var value=el.currentStyle?el.currentStyle[property]:null;return(el.style[property]||value)}}}else{return function(el,property){return el.style[property]}}})();var setStyle=(function(){if(browser.ie){return function(el,property,val){switch(property){case'opacity':el.style.filter='alpha(opacity='+val*100+')';if(!el.currentStyle||!el.currentStyle.hasLayout){el.style.zoom=1}break;case'float':property='styleFloat';default:el.style[property]=val}}}else{return function(el,property,val){if(property=='float'){property='cssFloat'}el.style[property]=val}}})();var getDocumentScrollLeft=function(doc){doc=doc||document;return Math.max(doc.documentElement.scrollLeft,doc.body.scrollLeft)};var getDocumentScrollTop=function(doc){doc=doc||document;return Math.max(doc.documentElement.scrollTop,doc.body.scrollTop)};var getXY=function(el){var pos=[el.offsetLeft,el.offsetTop];var parentNode=el.offsetParent;var accountForBody=(browser.safari&&getStyle(el,'position')=='absolute'&&el.offsetParent==el.ownerDocument.body);if(parentNode!=el){while(parentNode){pos[0]+=parentNode.offsetLeft;pos[1]+=parentNode.offsetTop;if(!accountForBody&&browser.safari&&getStyle(parentNode,'position')=='absolute'){accountForBody=true}parentNode=parentNode.offsetParent}}if(accountForBody){pos[0]-=el.ownerDocument.body.offsetLeft;pos[1]-=el.ownerDocument.body.offsetTop}parentNode=el.parentNode;while(parentNode.tagName&&!patterns.ROOT_TAG.test(parentNode.tagName)){if(getStyle(parentNode,'display').search(/^inline|table-row.*$/i)){pos[0]-=parentNode.scrollLeft;pos[1]-=parentNode.scrollTop}parentNode=parentNode.parentNode}return pos};function addEvent(obj,eventName,eventHandler){if(!obj)return;if(document.addEventListener){obj.addEventListener(eventName,eventHandler,true)}else if(document.attachEvent){obj.attachEvent("on"+eventName,eventHandler)}}var buildHTML=(function(){var buildImage=function(config){config.tag='img';config.attrs=config.attrs||{};config.attrs.src=config.url;config.attrs.border=0;return buildElement(config).replace('></img>','/>')};var buildFlash=function(config){var params=apply({quality:'high',allowScriptAccess:'always',wMode:'opaque',swLiveConnect:true},config.params||{});if(config.flashvars){apply(config.flashvars,{clickurl:config.clickurl});params.flashvars=toQueryString(config.flashvars)}config.attrs=config.attrs||{};if(browser.ie){config.attrs.classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000';params.movie=config.url}else{config.attrs.data=config.url;params.type='application/x-shockwave-flash'}var children=[];each(params,function(value,name){children.push({tag:'param',attrs:{name:name,value:value}})});return buildElement({tag:'object',attrs:config.attrs,styles:config.styles,children:children})};return function(config){if(!config.url.length){return''}return/.swf$/i.test(config.url)?buildFlash(config):buildImage(config)}})();var $time=Date.now||function(){return new Date().getTime()};function $clear(timer){clearTimeout(timer);clearInterval(timer);return null};var animateHeight=(function(){var fps=100;var compute=function(from,to,delta){return(to-from)*delta+from};return function(el,originHeight,destHeight,duration,transition){var startTime=$time();el.style.height=originHeight+'px';el.style.display='';el.style.overflow='hidden';var set=function(height){el.style.height=height+'px'};var timer=setInterval(function(){var time=$time();if(time<startTime+duration){var delta=transition((time-startTime)/duration);set(compute(originHeight,destHeight,delta))}else{set(compute(originHeight,destHeight,1));$clear(timer)}},Math.round(1000/fps))}})();var locate=(function(){var locateConfig={styles:{position:'relative',overflow:'hidden',width:'{width}',height:'{height}'},children:['{content}','{cover}','{button}']};var dropDownConfig={styles:{position:'absolute',width:'{width}',height:'{height}'},children:locateConfig};var locateTemplate=buildElement(locateConfig);var dropDownTemplate=buildElement(dropDownConfig);var buttonSize={width:74,height:21};var coverTemplate=buildElement({attrs:{id:'{cover_id}'},styles:{position:'absolute',width:'{width}',height:'{height}',background:'#fff',cursor:'pointer',left:0,top:0,'z-index':10,opacity:0,filter:'alpha(opacity=0)'}});var buttonTemplate=buildElement({tag:'img',attrs:{id:'{button_id}',src:'{img_src}'},styles:{filter:'Alpha(opacity=60)',opacity:0.6,right:-1,bottom:0,position:'absolute',width:buttonSize.width,height:buttonSize.height,'z-index':11,cursor:'pointer'}});return function(config){var controller=tencent_ad.flash[config.container]={};var container=$(config.container);var p1=config.p1,p2=config.p2;p1.needcover=p1.iscover=='N'?false:true;p2.needcover=p2.iscover=='N'?false:true;if(/.swf$|.flv$/.test(p2.flashvars.vurl)){if(p2.flashvars.vurl.match(/.swf$/)){p2.url=p2.flashvars.vurl;delete p2.flashvars}else{p2.needcover=false}}else{p2.url=""}p1.needbutton=p2.url;p2.needbutton=p1.needbutton;var buttonOpenId=getId();var p1CoverId=getId();var p1ContentId=getId();p1.attrs={id:p1ContentId};var p1width=p1.styles.width;var p1height=p1.styles.height;var locateHTML=locateTemplate.format({width:p1width,height:p1height,content:buildHTML(p1),cover:p1.needcover?coverTemplate.format({cover_id:p1CoverId,width:p1width,height:p1height}):'',button:p1.needbutton?buttonTemplate.format({button_id:buttonOpenId,img_src:config.play_img_src}):''});container.innerHTML=locateHTML;var p1ContentEl=$(p1ContentId);var buttonCloseId=getId();var p2id=getId();var p2flashId=getId();p2.attrs={id:p2flashId};var p2CoverId=getId();var p2width=p2.styles.width;var p2height=p2.styles.height;var popupHTML=buildElement({attrs:{id:p2id},styles:{position:'absolute','z-index':9999,width:p2width,height:p2height,left:'-9999px',display:'none'},children:locateTemplate.format({width:p2width,height:p2height,content:buildHTML(p2),cover:p2.needcover?coverTemplate.format({cover_id:p2CoverId,width:p2width,height:p2height}):'',button:p2.needbutton?buttonTemplate.format({button_id:buttonCloseId,img_src:config.stop_img_src}):''})});document.body.insertBefore(createElement(popupHTML),document.body.firstChild);var p2container=$(p2id);var flashObj=$(p2flashId);var slide_down_transition=function(p){return Math.pow(p,6)};var slide_up_transition=function(p){return Math.pow(p,1/6)};var playing=false;var layout=function(){if(!playing){return}var xy=getXY(p1ContentEl);p2container.style.left=xy[0]+'px';p2container.style.top=xy[1]+'px'};addEvent(window,'resize',layout);var openFlash=function(){playing=true;p2container.style.height=p1height+'px';layout();animateHeight(p2container,p1height,p2height,p2.durationbegin,slide_down_transition);setTimeout(function(){try{flashObj.mplay?flashObj.mplay():flashObj.Play()}catch(e){}if(browser.ie){showIframe(getXY(p1ContentEl),[p2width,p2height])}},p2.durationbegin)};var closeFlash=function(){playing=false;animateHeight(p2container,p2height,p1height,p2.durationend,slide_up_transition);setTimeout(function(){p2container.style.left='-9999px'},p2.durationend);try{flashObj.Pause?flashObj.Pause():flashObj.StopPlay()}catch(e){}if(browser.ie){hideIframe()}};var v_iframe;var showIframe=function(arr_xy,arr_wh){if(!v_iframe){v_iframe=document.createElement('iframe');apply(v_iframe.style,{zIndex:1,position:'absolute',width:arr_wh[0]+'px',height:arr_wh[1]+'px'});document.body.insertBefore(v_iframe,document.body.firstChild)}apply(v_iframe.style,{left:arr_xy[0]+'px',top:arr_xy[1]+'px'})};var hideIframe=function(){v_iframe.style.left='-9999px'};var timer;if(p1.needbutton){try{p2container.style.display="block";setTimeout(function(){flashObj.Pause?flashObj.Pause():flashObj.StopPlay()})}catch(e){}container.onmouseover=function(){if(!timer){timer=setTimeout(function(){openFlash()},1000)}};container.onmouseout=function(){clearTimeout(timer);timer=null}}if(p1.needbutton){$(buttonOpenId).onclick=function(){openFlash()}}if(p1.needbutton){$(buttonCloseId).onclick=function(){closeFlash()}}if(p1.needcover){$(p1CoverId).onclick=function(){open(p1.clickurl)}}if(p2.needcover){$(p2CoverId).onclick=function(){open(p2.clickurl)}}controller.stopClose=closeFlash}})();return{flash:{},setStyle:setStyle,getStyle:getStyle,getXY:getXY,buildHTML:buildHTML,locate:locate}})()}function stopClose(jsid){tencent_ad.flash[jsid].stopClose()}
